<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portalt - Implementation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header bg-white shadow-sm py-3 fixed-top">
        <div class="container">
            <div class="row align-items-center justify-content-between">
                <div class="col-md-3">
                    <div class="d-flex align-items-center">
                        <img src="assets/images/Portalt-Logo.png" alt="Portalt Logo" class="logo me-3">
                    </div>
                </div>
                <div class="col-md-9">
                    <nav class="navbar navbar-expand-lg navbar-light">
                        <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                            <ul class="navbar-nav">
                                <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                                <li class="nav-item"><a class="nav-link" href="requirements.html">Requirements</a></li>
                                <li class="nav-item"><a class="nav-link" href="research.html">Research</a></li>
                                <li class="nav-item"><a class="nav-link" href="ui-design.html">UI Design</a></li>
                                <li class="nav-item"><a class="nav-link" href="system-design.html">System Design</a></li>
                                <li class="nav-item"><a class="nav-link active" href="implementation.html">Implementation</a></li>
                                <li class="nav-item"><a class="nav-link" href="testing.html">Testing</a></li>
                                <li class="nav-item"><a class="nav-link" href="evaluation.html">Evaluation</a></li>
                                <li class="nav-item"><a class="nav-link" href="appendices.html">Appendices</a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <!-- Page Title -->
    <section class="page-title py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1 class="display-4 fw-bold">Implementation</h1>
                    <p class="lead">Detailed explanation of how key features were implemented in the Portalt platform</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Implementation Overview -->
    <section id="implementation-overview" class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card border-0 shadow rounded-4 p-4 bg-white" data-aos="fade-up">
                        <div class="card-body">
                            <h2 class="mb-4">Implementation Overview</h2>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Architecture Overview</h3>
                                <p class="mb-4">
                                    The Portalt platform is implemented using a modern, scalable architecture that combines web technologies with Unity-based VR/AR capabilities. 
                                    The system is built on a microservices architecture with clear separation of concerns between the admin dashboard, Unity applications, and backend services.
                                </p>
                                <p class="mb-4">
                                    The architecture follows a layered approach, with each component handling specific responsibilities:
                                </p>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Frontend Layer: Next.js-based admin dashboard for scene management and configuration</li>
                                    <li>• Backend Layer: Node.js services handling data persistence and business logic</li>
                                    <li>• Storage Layer: Hybrid storage system using SQLite for configurations and IBM Cloud Object Storage for assets</li>
                                    <li>• Unity Layer: VR/AR applications consuming scene configurations and assets</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Technology Stack</h3>
                                <p class="mb-4">
                                    The platform leverages modern web technologies and cloud services to deliver a robust VR/AR experience:
                                </p>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Frontend Technologies</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Next.js for the admin dashboard</li>
                                            <li>• React for UI components</li>
                                            <li>• TypeScript for type safety</li>
                                            <li>• Tailwind CSS for styling</li>
                                        </ul>
                                        <p class="small text-muted mt-2">
                                            The frontend stack is chosen for its developer experience, type safety, and component reusability.
                                        </p>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Backend Technologies</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Node.js with Express</li>
                                            <li>• SQLite for configuration storage</li>
                                            <li>• IBM Cloud Object Storage for assets</li>
                                            <li>• WebSocket for real-time updates</li>
                                        </ul>
                                        <p class="small text-muted mt-2">
                                            The backend stack prioritizes performance, scalability, and real-time capabilities.
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Key Implementation Features</h3>
                                <p class="mb-4">
                                    The platform implements several key features that work together to provide a seamless VR/AR experience:
                                </p>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Core Features</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• VR environment creation and management</li>
                                            <li>• Interactive 3D object placement</li>
                                            <li>• User authentication and organization management</li>
                                            <li>• Real-time scene synchronization</li>
                                            <li>• Asset management and storage</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Technical Features</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Type-safe API development</li>
                                            <li>• Secure authentication flow</li>
                                            <li>• Efficient asset delivery</li>
                                            <li>• Real-time data synchronization</li>
                                            <li>• Cross-platform compatibility</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Development Approach</h3>
                                <p class="mb-4">
                                    The implementation follows a modular, component-based approach with emphasis on:
                                </p>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Clean code architecture and SOLID principles</li>
                                    <li>• Comprehensive error handling and validation</li>
                                    <li>• Performance optimization and caching strategies</li>
                                    <li>• Security-first development practices</li>
                                    <li>• Automated testing and continuous integration</li>
                                </ul>
                                <p class="small text-muted">
                                    This approach ensures maintainable code, reliable performance, and robust security.
                                </p>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Integration Points</h3>
                                <p class="mb-4">
                                    The platform integrates with various services and systems to provide a complete solution:
                                </p>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">External Services</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Clerk for authentication</li>
                                            <li>• IBM Cloud Object Storage</li>
                                            <li>• Unity VR/AR applications</li>
                                            <li>• WebSocket server for real-time updates</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Internal Systems</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Scene configuration management</li>
                                            <li>• Asset processing pipeline</li>
                                            <li>• User session management</li>
                                            <li>• Organization-based access control</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Performance Considerations</h3>
                                <p class="mb-4">
                                    The implementation includes several performance optimizations to ensure smooth operation:
                                </p>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Efficient asset loading and caching</li>
                                    <li>• Optimized database queries</li>
                                    <li>• Batch processing for multiple operations</li>
                                    <li>• Progressive loading of 3D models</li>
                                    <li>• WebSocket-based real-time updates</li>
                                </ul>
                                <p class="small text-muted">
                                    These optimizations are crucial for delivering a responsive VR/AR experience.
                                </p>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Security Measures</h3>
                                <p class="mb-4">
                                    Security is implemented at multiple levels to protect user data and assets:
                                </p>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Secure authentication and authorization</li>
                                    <li>• Organization-based data isolation</li>
                                    <li>• Secure asset access control</li>
                                    <li>• API request validation</li>
                                    <li>• Environment-based configuration</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Testing Strategy</h3>
                                <p class="mb-4">
                                    The implementation includes comprehensive testing to ensure reliability:
                                </p>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Unit tests for core functionality</li>
                                    <li>• Integration tests for API endpoints</li>
                                    <li>• End-to-end testing of user flows</li>
                                    <li>• Performance testing and optimization</li>
                                    <li>• Security testing and validation</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Future Considerations</h3>
                                <p class="mb-4">
                                    The implementation is designed to support future enhancements:
                                </p>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Scalable architecture for growth</li>
                                    <li>• Modular design for feature additions</li>
                                    <li>• Support for additional VR/AR features</li>
                                    <li>• Enhanced collaboration capabilities</li>
                                    <li>• Advanced analytics and reporting</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Key Feature 1 -->
    <section id="feature-1" class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card border-0 shadow rounded-4 p-4 bg-white" data-aos="fade-up">
                        <div class="card-body">
                            <h2 class="mb-4">Key Feature 1: VR Environment Creation</h2>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Overview</h3>
                                <p class="mb-4">
                                    The application implements a comprehensive VR environment creation system that allows users to create, configure, and manage 3D scenes for VR activities. 
                                    The system supports 3D object placement, scene configuration, and real-time synchronization with Unity applications.
                                </p>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Implementation Details</h3>

                                <h4 class="h5 mb-3">1. Scene Configuration System</h4>
                                
                                <h5 class="h6 mb-2">1.1 Scene Data Structure</h5>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">interface SceneConfiguration {
  _id?: string;
  activity_id: string;
  scene_id: string;
  objects: SceneObject[];
  orgId: string;
  createdAt: Date;
  updatedAt: Date;
}

interface SceneObject {
  object_id: string;
  modelUrl: string;
  position: Vector3;
  rotation: Vector3;
  scale: Vector3;
}

interface Vector3 {
  x: number;
  y: number;
  z: number;
}</code></pre>

                                <h5 class="h6 mb-2">1.2 Scene Editor Component</h5>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">export function SceneEditor({ activity }: SceneEditorProps) {
  const [selectedScene, setSelectedScene] = useState&lt;string | null&gt;(null);
  const [sceneConfigs, setSceneConfigs] = useState&lt;Record&lt;string, any&gt;&gt;({});
  
  // Initialize scene for VR activities
  useEffect(() => {
    if (activity.format === 'VR' && activity.scenes?.[0]) {
      setSelectedScene(activity.scenes[0].id);
      setSceneConfigs(prev => ({
        ...prev,
        [activity.scenes[0].id]: activity.scenes[0].config
      }));
    }
  }, [activity]);
}</code></pre>

                                <h4 class="h5 mb-3">2. 3D Object Management</h4>
                                
                                <h5 class="h6 mb-2">2.1 Object Addition</h5>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">const handleAddArtifact = async (sceneId: string, artifact: any) => {
  const newObject = {
    object_id: crypto.randomUUID(),
    modelUrl: artifact.modelUrl,
    position: { x: 0, y: 0, z: 0 },
    rotation: { x: 0, y: 0, z: 0 },
    scale: { x: 1, y: 1, z: 1 }
  };

  const currentConfig = sceneConfigs[sceneId] || { objects: [] };
  const currentObjects = Array.isArray(currentConfig.objects) ? currentConfig.objects : [];

  await fetch(`/api/scenes-configuration/${sceneId}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      objects: [...currentObjects, newObject]
    })
  });
};</code></pre>

                                <h5 class="h6 mb-2">2.2 Object Transformation</h5>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">const handleUpdateArtifact = async (sceneId: string, objectId: string, updated: any) => {
  const updatedObjects = sceneConfigs[sceneId]?.objects?.map((obj: { object_id: string; }) => 
    obj.object_id === objectId ? { ...obj, ...updated } : obj
  ) || [];

  await fetch(`/api/scenes-configuration/${sceneId}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      objects: updatedObjects
    })
  });
};</code></pre>
                            </div>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Scene Creation Flow</h3>
                                <div class="text-center my-4">
                                    <img src="assets/images/graphs-n-schemas/scene-creation-flow.svg" alt="Scene Creation Flow Diagram" class="img-fluid" style="max-width: 800px;">
                                </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Unity Integration</h3>
                                
                                <h4 class="h5 mb-3">1. Scene Configuration Access</h4>
                                <p class="mb-3">
                                    Unity applications can access scene configurations through public API endpoints:
                                </p>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Example Unity API call
const response = await fetch(`/api/scenes-configuration/${sceneId}?orgId=${orgId}`);
const config = await response.json();</code></pre>

                                <h4 class="h5 mb-3">2. 3D Model Access</h4>
                                <p class="mb-3">
                                    Unity applications can access 3D models through public COS URLs:
                                </p>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Example model URL structure
const modelUrl = `https://${bucketName}.s3.${region}.cloud-object-storage.appdomain.cloud/documents/${modelKey}`;</code></pre>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Scene Editor Features</h3>
                                
                                <h4 class="h5 mb-3">1. Object Manipulation</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Position adjustment (x, y, z coordinates)</li>
                                    <li>• Rotation control (x, y, z angles)</li>
                                    <li>• Scale modification (x, y, z dimensions)</li>
                                    <li>• Real-time preview</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Asset Management</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• 3D model upload</li>
                                    <li>• Asset library integration</li>
                                    <li>• Model format validation</li>
                                    <li>• Automatic asset categorization</li>
                                </ul>

                                <h4 class="h5 mb-3">3. Scene Organization</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Multiple scene support</li>
                                    <li>• Scene naming and ordering</li>
                                    <li>• Scene duplication</li>
                                    <li>• Scene deletion</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Data Synchronization</h3>
                                
                                <h4 class="h5 mb-3">1. Real-time Updates</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Scene configuration changes</li>
                                    <li>• Object transformations</li>
                                    <li>• Asset updates</li>
                                    <li>• Unity app synchronization</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Version Control</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Scene version tracking</li>
                                    <li>• Change history</li>
                                    <li>• Rollback capability</li>
                                    <li>• Conflict resolution</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Security Implementation</h3>
                                
                                <h4 class="h5 mb-3">1. Access Control</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Organization-based access</li>
                                    <li>• Scene-level permissions</li>
                                    <li>• Asset access control</li>
                                    <li>• API authentication</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Data Validation</h4>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Example validation
if (!format || !["AR", "VR"].includes(format)) {
  return res.status(400).json({ message: "Valid format (AR/VR) is required" });
}</code></pre>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Performance Optimization</h3>
                                
                                <h4 class="h5 mb-3">1. Asset Loading</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Progressive loading</li>
                                    <li>• Asset caching</li>
                                    <li>• Lazy loading</li>
                                    <li>• Format optimization</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Scene Management</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Efficient scene switching</li>
                                    <li>• Memory management</li>
                                    <li>• Resource cleanup</li>
                                    <li>• Batch operations</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Error Handling</h3>
                                
                                <h4 class="h5 mb-3">1. Validation Errors</h4>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">try {
  const parseResult = ActivitySchema.safeParse(newActivity);
  if (!parseResult.success) {
    return res.status(400).json({ errors: parseResult.error.format() });
  }
} catch (error) {
  console.error("[ACTIVITIES_POST]", error);
  return res.status(500).json({ message: "Internal Error" });
}</code></pre>

                                <h4 class="h5 mb-3">2. Asset Errors</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• File format validation</li>
                                    <li>• Upload error handling</li>
                                    <li>• URL validation</li>
                                    <li>• Access error recovery</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Testing Considerations</h3>
                                
                                <h4 class="h5 mb-3">1. Scene Editor Tests</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Object manipulation</li>
                                    <li>• Scene configuration</li>
                                    <li>• Asset management</li>
                                    <li>• Error handling</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Integration Tests</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Unity app integration</li>
                                    <li>• API endpoints</li>
                                    <li>• Data synchronization</li>
                                    <li>• Performance metrics</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Future Enhancements</h3>
                                
                                <h4 class="h5 mb-3">1. Planned Features</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Advanced object manipulation</li>
                                    <li>• Scene templates</li>
                                    <li>• Collaborative editing</li>
                                    <li>• Real-time preview</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Performance Improvements</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Asset optimization</li>
                                    <li>• Scene loading optimization</li>
                                    <li>• Memory management</li>
                                    <li>• Network efficiency</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Key Feature 2 -->
    <section id="feature-2" class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card border-0 shadow rounded-4 p-4 bg-white" data-aos="fade-up">
                        <div class="card-body">
                            <h2 class="mb-4">Key Feature 2: Interactive Object Placement</h2>
                            
                            <!-- Placeholder for feature 2 content -->
                            
                            <div class="code-snippet mt-4">
                                <h4 class="h5 mb-3">Code Snippet</h4>
                                <pre class="bg-light p-3 rounded-4"><code class="language-csharp">
// Code snippet will be added later
                                </code></pre>
                            </div>
                            
                            <div class="implementation-diagram mt-4">
                                <h4 class="h5 mb-3">Implementation Diagram</h4>
                                <!-- Placeholder for diagram -->
                                <div class="image-placeholder bg-light rounded-4 d-flex align-items-center justify-content-center" style="height: 300px;">
                                    <p class="text-muted">Implementation Diagram for Interactive Object Placement</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Key Feature 3 -->
    <section id="feature-3" class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card border-0 shadow rounded-4 p-4 bg-white" data-aos="fade-up">
                        <div class="card-body">
                            <h2 class="mb-4">Key Feature 3: User Authentication and Management</h2>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Overview</h3>
                                <p class="mb-4">The application implements a comprehensive authentication and user management system using Clerk, a modern authentication service. The system provides secure user authentication, organization management, and role-based access control.</p>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Implementation Details</h3>
                                
                                <h5 class="h6 mb-2">2.1 Authentication Provider</h5>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">&lt;!-- src/pages/_app.tsx --&gt;
import { ClerkProvider } from "@clerk/nextjs";

export default function MyApp({ Component, pageProps }: AppProps) {
  return (
    &lt;ClerkProvider {...pageProps}&gt;
      &lt;Layout&gt;
        &lt;Component {...pageProps} /&gt;
      &lt;/Layout&gt;
    &lt;/ClerkProvider&gt;
  );
}</code></pre>

                                <h5 class="h6 mb-2">2.2 Authentication Pages</h5>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">&lt;!-- src/pages/sign-in/[[...rest]]/index.tsx --&gt;
import { SignIn } from "@clerk/nextjs";

export default function LoginPage() {
  return (
    &lt;main className="h-screen w-full flex items-center justify-center bg-gray-50"&gt;
      &lt;div className="w-full max-w-md p-8"&gt;
        &lt;h1 className="text-2xl font-bold text-center mb-8 text-gray-800"&gt;
          Welcome Back
        &lt;/h1&gt;
        &lt;SignIn /&gt;
      &lt;/div&gt;
    &lt;/main&gt;
  );
}</code></pre>

                                <h4 class="h5 mb-3">3. Middleware Implementation</h4>
                                <p class="mb-3">The application implements a custom middleware to handle authentication and organization selection:</p>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// src/middleware.ts
export default clerkMiddleware(async (auth, req) =&gt; {
  const { userId, sessionClaims, redirectToSignIn } = await auth();

  // Handle public routes
  if(isPublicRoute(req)){
    return NextResponse.next();
  }

  // Handle unauthenticated users
  if (!userId) {
    return redirectToSignIn();
  }

  // Handle organization selection
  if (userId && !sessionClaims.org_id && 
      req.nextUrl.pathname !== "/organization-select") {
    return Response.redirect(new URL("/organization-select", req.url));
  }

  return NextResponse.next();
});</code></pre>

                                <h4 class="h5 mb-3">4. Organization Management</h4>
                                <p class="mb-3">The application implements organization-based access control:</p>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// src/pages/organization-select/index.tsx
import { OrganizationList } from "@clerk/nextjs";

export default function OrganizationSelectPage() {
  return (
    &lt;main className="h-screen w-full flex items-center justify-center bg-gray-50"&gt;
      &lt;div className="w-full max-w-md p-8"&gt;
        &lt;h1 className="text-2xl font-bold text-center mb-8 text-gray-800"&gt;
          Select Organization
        &lt;/h1&gt;
        &lt;OrganizationList
          afterCreateOrganizationUrl="/"
          afterSelectOrganizationUrl="/"
        /&gt;
      &lt;/div&gt;
    &lt;/main&gt;
  );
}</code></pre>

                                <h4 class="h5 mb-3">5. API Authentication</h4>
                                <p class="mb-3">All API routes implement organization-based authentication:</p>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Example API route with authentication
export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  const { orgId } = getAuth(req);
  if (!orgId) return res.status(401).json({ message: "Unauthorized" });
  
  // Protected route logic
}</code></pre>
                            </div>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Authentication Flow</h3>
                                <img src="assets/images/graphs-n-schemas/auth-flow-diagram.svg" alt="Authentication Flow Diagram" class="img-fluid rounded-4 mb-4" style="max-width: 90%; max-height: 500px; width: auto; display: block; margin: 0 auto; background-color: white;">
                                <div class="diagram-description">
                                    <p class="mb-3"><strong>Flow Description:</strong></p>
                                    <ul class="list-unstyled ms-4 mb-3">
                                        <li>• User accesses application</li>
                                        <li>• System checks authentication status</li>
                                        <li>• Unauthenticated users are redirected to sign in</li>
                                        <li>• After authentication, organization selection is required</li>
                                        <li>• Organization selection grants access to protected content</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Security Features</h3>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Session Management</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Secure session handling through Clerk</li>
                                            <li>• Automatic session expiration</li>
                                            <li>• Multi-device session support</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Organization Isolation</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Data isolation per organization</li>
                                            <li>• Organization-specific access control</li>
                                            <li>• Organization switching capability</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">API Security</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Organization-based API access</li>
                                            <li>• Secure token handling</li>
                                            <li>• Rate limiting support</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Public Routes</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Defined public access paths</li>
                                            <li>• Secure public route handling</li>
                                            <li>• Authentication bypass for specific routes</li>
                                        </ul>
                        </div>
                    </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Implementation Benefits</h3>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Security & Scalability</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Professional-grade authentication</li>
                                            <li>• Regular security updates</li>
                                            <li>• Built-in organization management</li>
                                            <li>• Efficient session handling</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">User Experience & Maintenance</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Seamless authentication flow</li>
                                            <li>• Organization switching</li>
                                            <li>• Reduced security maintenance</li>
                                            <li>• Automated updates</li>
                                        </ul>
                </div>
            </div>
        </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Environment Configuration</h3>
                                <pre class="bg-light p-3 rounded-4"><code class="language-bash"># Required environment variables
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=your_publishable_key
CLERK_SECRET_KEY=your_secret_key</code></pre>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Error Handling</h3>
                                <p class="mb-3">The authentication system implements comprehensive error handling:</p>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Invalid credentials</li>
                                    <li>• Session expiration</li>
                                    <li>• Organization access errors</li>
                                    <li>• API authentication failures</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Testing Considerations</h3>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Authentication Tests</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Login flow</li>
                                            <li>• Organization selection</li>
                                            <li>• Session management</li>
                                            <li>• Error scenarios</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Security Tests</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Token validation</li>
                                            <li>• Organization isolation</li>
                                            <li>• API access control</li>
                                            <li>• Public route access</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Future Enhancements</h3>
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Planned Features</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Role-based access control</li>
                                            <li>• Multi-factor authentication</li>
                                            <li>• OAuth provider integration</li>
                                            <li>• Custom authentication flows</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <h5 class="h6 fw-bold mb-2">Security Improvements</h5>
                                        <ul class="list-unstyled ms-4">
                                            <li>• Enhanced session management</li>
                                            <li>• Advanced organization policies</li>
                                            <li>• Audit logging</li>
                                            <li>• Security analytics</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Key Feature 5 -->
    <section id="feature-5" class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card border-0 shadow rounded-4 p-4 bg-white" data-aos="fade-up">
                        <div class="card-body">
                            <h2 class="mb-4">Key Feature 5: Data Storage and Synchronization</h2>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Overview</h3>
                                <p class="mb-4">
                                    The data storage and synchronization system implements a hybrid approach using IBM Cloud Object Storage (COS) for asset storage 
                                    and SQLite for scene configuration data. This architecture ensures efficient storage of large assets while maintaining 
                                    quick access to configuration data.
                                </p>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Implementation</h3>

                                <h4>COS Client Configuration</h4>
                                <pre><code class="language-typescript">
import { S3 } from 'aws-sdk';

const cosClient = new S3({
    endpoint: process.env.COS_ENDPOINT,
    credentials: {
        accessKeyId: process.env.COS_ACCESS_KEY_ID,
        secretAccessKey: process.env.COS_SECRET_ACCESS_KEY
    },
    region: process.env.COS_REGION
});
                                </code></pre>

                                <h4>File Upload and URL Generation</h4>
                                <pre><code class="language-typescript">
async function uploadAsset(file: File, key: string): Promise<string> {
    const params = {
        Bucket: process.env.COS_BUCKET_NAME,
        Key: key,
        Body: file,
        ContentType: file.type
    };

    await cosClient.upload(params).promise();
    
    return cosClient.getSignedUrl('getObject', {
        Bucket: process.env.COS_BUCKET_NAME,
        Key: key,
        Expires: 3600 // URL expires in 1 hour
    });
}
                                </code></pre>

                                <h4>Scene Configuration Storage</h4>
                                <pre><code class="language-typescript">
interface SceneConfig {
    id: string;
    name: string;
    assets: Array<{
        id: string;
        url: string;
        type: string;
        position: { x: number; y: number; z: number; }
    }>;
}

async function saveSceneConfig(config: SceneConfig): Promise<void> {
    await db.run(`
        INSERT OR REPLACE INTO scene_configs (id, name, config)
        VALUES (?, ?, ?)
    `, [config.id, config.name, JSON.stringify(config)]);
}
                                </code></pre>

                                <h4>API Handling</h4>
                                <pre><code class="language-typescript">
app.post('/api/scenes/:id/assets', async (req, res) => {
    try {
        const file = req.files.asset;
        const sceneId = req.params.id;
        const key = `scenes/${sceneId}/${file.name}`;
        
        const url = await uploadAsset(file, key);
        const config = await getSceneConfig(sceneId);
        
        config.assets.push({
            id: uuidv4(),
            url,
            type: file.type,
            position: req.body.position
        });
        
        await saveSceneConfig(config);
        
        res.json({ success: true, url });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});
                                </code></pre>
                            </div>
                            
                            <div class="mb-4">
                                <h3 class="h4 mb-3">Data Flow Diagram</h3>
                                <div class="text-center my-4">
                                    <img src="assets/images/graphs-n-schemas/data-flow-diagram.svg" alt="Data Flow Diagram" class="img-fluid" style="max-width: 800px;">
                                </div>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Unity Integration</h3>
                                
                                <h4 class="h5 mb-3">1. Scene Configuration Access</h4>
                                <p class="mb-3">
                                    The Unity application accesses scene configurations through a dedicated API client that handles:
                                </p>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Example Unity API call
const response = await fetch(`/api/scenes-configuration/${sceneId}?orgId=${orgId}`);
const config = await response.json();</code></pre>

                                <h4 class="h5 mb-3">2. Asset Access</h4>
                                <p class="mb-3">
                                    Unity applications can access assets through public COS URLs:
                                </p>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Example asset URL structure
const assetUrl = `https://${bucketName}.s3.${region}.cloud-object-storage.appdomain.cloud/documents/${assetKey}`;</code></pre>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Security Implementation</h3>
                                
                                <h4 class="h5 mb-3">1. Access Control</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Organization-based access control</li>
                                    <li>• Signed URLs for COS assets with expiration</li>
                                    <li>• Public URLs for Unity app access</li>
                                    <li>• Token-based authentication for API access</li>
                                </ul>

                                <h4 class="h5 mb-3">2. URL Security</h4>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Generate short-lived signed URL for sensitive operations
export async function getSignedUrl(key: string, expiresIn: number = 3600): Promise&lt;string&gt; {
  const cos = getCosClient();
  return cos.getSignedUrl('getObject', {
    Bucket: BUCKET_NAME,
    Key: key,
    Expires: expiresIn,
  });
}</code></pre>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Data Synchronization</h3>
                                
                                <h4 class="h5 mb-3">1. Real-time Updates</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Scene configurations are updated in real-time</li>
                                    <li>• Unity apps poll for configuration updates</li>
                                    <li>• Asset changes are immediately reflected</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Conflict Resolution</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Last-write-wins strategy for scene configurations</li>
                                    <li>• Version tracking for asset updates</li>
                                    <li>• Atomic updates for critical operations</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Performance Optimization</h3>
                                
                                <h4 class="h5 mb-3">1. Caching Strategy</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• In-memory caching of frequently accessed configurations</li>
                                    <li>• Local storage of commonly used assets</li>
                                    <li>• CDN integration for asset delivery</li>
                                </ul>

                                <h4 class="h5 mb-3">2. Batch Operations</h4>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">// Example batch asset upload
const uploadPromises = files.map(file => 
  uploadDocument(file.buffer, file.name, file.mimetype)
);
await Promise.all(uploadPromises);</code></pre>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Error Handling</h3>
                                
                                <h4 class="h5 mb-3">1. Storage Errors</h4>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-typescript">try {
  await uploadDocument(file, filename, mimeType);
} catch (error) {
  console.error('Error uploading to COS:', {
    error: error instanceof Error ? {
      message: error.message,
      stack: error.stack,
      name: error.name
    } : error,
    bucket: BUCKET_NAME,
    filename
  });
  throw error;
}</code></pre>

                                <h4 class="h5 mb-3">2. Synchronization Errors</h4>
                                <ul class="list-unstyled ms-4 mb-4">
                                    <li>• Retry mechanisms for failed uploads</li>
                                    <li>• Fallback options for unavailable assets</li>
                                    <li>• Error reporting and logging</li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Environment Configuration</h3>
                                <pre class="bg-light p-3 rounded-4 mb-4"><code class="language-bash"># Required environment variables
COS_ENDPOINT=https://s3.us-east.cloud-object-storage.appdomain.cloud
COS_ACCESS_KEY_ID=your_access_key_id
COS_SECRET_ACCESS_KEY=your_secret_access_key
COS_REGION=us-east
COS_BUCKET_NAME=your_bucket_name

# Database configuration
SQLITE_PATH=./data/scene_configs.db
MAX_CACHE_SIZE=100MB
ASSET_CACHE_DURATION=3600</code></pre>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Testing Considerations</h3>
                                <ul>
                                    <li>Storage Tests:
                                        <ul>
                                            <li>Asset upload/download verification</li>
                                            <li>Configuration CRUD operations</li>
                                            <li>URL generation and expiration</li>
                                            <li>Error handling and retry logic</li>
                                        </ul>
                                    </li>
                                    <li>Integration Tests:
                                        <ul>
                                            <li>Unity client integration</li>
                                            <li>Synchronization mechanisms</li>
                                            <li>Performance under load</li>
                                            <li>Security implementation</li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>

                            <div class="mb-4">
                                <h3 class="h4 mb-3">Future Enhancements</h3>
                                <ul>
                                    <li>Advanced caching mechanisms with predictive prefetching</li>
                                    <li>Multi-region asset distribution</li>
                                    <li>Real-time collaborative editing features</li>
                                    <li>Enhanced conflict resolution strategies</li>
                                    <li>Automated asset optimization pipeline</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer py-5 bg-dark text-white">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-4 mb-md-0">
                    <h5>Portalt</h5>
                    <p class="small">A revolutionary VR/AR platform for creating interactive, customizable virtual tours.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-0">© 2025 Team 20. All rights reserved.</p>
                    <a href="https://github.com/your-repo" class="github-link mt-2" target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script src="script.js"></script>
</body>
</html>
